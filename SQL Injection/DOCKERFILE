FROM python:3.8-slim-buster

RUN apt-get update
RUN apt-get install python3-pip curl -y 
RUN python3 -m pip install --upgrade pip==22.0.4
ADD db.sqlite /code/db.sqlite
ADD run.sh /code/run.sh
ADD setupDB.py /code/setupDB.py
ADD sql.py /code/sql.py


WORKDIR /code

RUN adduser --disabled-password --gecos '' ctf
RUN adduser --disabled-password --gecos '' worker

EXPOSE 5002

CMD ["gunicorn", "-w", "25", "-b", "127.0.0.1:5002", "--user", "worker", "server:app"]
